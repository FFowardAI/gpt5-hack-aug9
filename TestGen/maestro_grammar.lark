// Maestro YAML (web focused) â€“ strict, GPT-5 friendly grammar
// Accepts either url: or appId: header. Encourages simple one-line commands.

start: header NL SEP NL steps
header: ("url:" SP URL) | ("appId:" SP STRING)
SEP: "---"

steps: step (step)* (NL)?
step: "-" SP command NL?

command: "launchApp"
       | "back"
       | "hideKeyboard"
       | "waitForAnimationToEnd"
       | "clearState"
       | "clearKeychain"
       | "tapOn:" SP STRING              // Simple string form only
       | "inputText:" SP STRING
       | "assertVisible:" SP STRING
       | "assertNotVisible:" SP STRING
       | "openLink:" SP STRING
       | take_screenshot_simple          // takeScreenshot: "name" (one line)
       | press_key_map
       | erase_text_map
       | scroll_map
       | swipe_map
       | run_flow_map
       | run_script_map

// Maps that remain accepted (with 2-space indentation)
press_key_map: "pressKey:" NL SP2 "key:" SP KEY

erase_text_map: "eraseText:" NL SP2 "characters:" SP INT

scroll_map: "scroll:" NL SP2 "direction:" SP DIRECTION (NL SP2 "times:" SP INT)?

swipe_map: "swipe:" NL SP2 "direction:" SP DIRECTION (NL SP2 "durationMs:" SP INT)?

run_flow_map: "runFlow:" NL SP2 "file:" SP PATH

run_script_map: "runScript:" NL SP2 "file:" SP PATH

// Screenshot must be single-line (matches working example in a.yaml)
take_screenshot_simple: "takeScreenshot:" SP (STRING | NAME)

// Common tokens
SP: " "
SP2: "  "
SP4: "    "
NL: /\r?\n/
STRING: /"[^"\n]{1,200}"/
URL: /[^\s\n]+/
PATH: STRING
NAME: /[A-Za-z0-9_\-]{1,100}/
INT: /[0-9]{1,6}/
BOOL: "true" | "false"
DIRECTION: "up" | "down" | "left" | "right"
KEY: "enter" | "return" | "go" | "done" | "tab" | "escape" | "space" | "backspace" | "delete" | "back" | "home" | "menu" | "search" | "volumeUp" | "volumeDown" | "camera" | "up" | "down" | "left" | "right"
PLATFORM: "iOS" | "Android"
